<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>blog-ydnaz - misc</title><link href="/" rel="alternate"></link><link href="/feeds/misc.atom.xml" rel="self"></link><id>/</id><updated>2020-06-30T22:30:00+07:00</updated><entry><title>Membangun Mariadb Cluster menggunakan Galera Cluster part 1</title><link href="/membangun-mariadb-cluster-menggunakan-galera-cluster-part-1.html" rel="alternate"></link><published>2020-06-30T22:30:00+07:00</published><updated>2020-06-30T22:30:00+07:00</updated><author><name>me</name></author><id>tag:None,2020-06-30:/membangun-mariadb-cluster-menggunakan-galera-cluster-part-1.html</id><summary type="html">&lt;p&gt;Install dan konfigurasi Maridb Cluster&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;strong&gt;&lt;em&gt;Introduction:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Untuk membuat Clustering Database system di MariaDB maka bisa menggunakan Galera. 
Galera sendiri sudah termasuk kedalam paket instalasi pada MariaDB sehingga tidak dibutuhkan instalasi paket tambahan.
Namun jika ingin menggunakan versi galera yang lebih tinggi seperti galera-3 di MariaDB 10.3 dan 
galera-4 di MariaDB 10.4 maka butuh menambahlak paket &lt;em&gt;galera-3&lt;/em&gt; dan &lt;em&gt;galera-4&lt;/em&gt; untuk menginstall 
wsrep provider librarynya.&lt;/p&gt;
&lt;p&gt;Beberapa Fitur yang ditawarkan dari Galera Cluster diantaranya:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;True Multi-Master&lt;/em&gt;&lt;/strong&gt; 
You can read and write to any node at any time. 
Changes to data on one node will be replicated on all. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Synchronous Replication&lt;/em&gt;&lt;/strong&gt; 
There is no slave lag, so no data is lost if a node crashes.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Tightly Coupled&lt;/em&gt;&lt;/strong&gt; 
All nodes hold the same state. There is no diverged data between nodes. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Multi-Threaded Slave&lt;/em&gt;&lt;/strong&gt; 
This allows for better performance and for any workload. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;No Master-Slave Failover&lt;/em&gt;&lt;/strong&gt; 
There is no need for master-slave operations or to use VIP. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Hot Standby&lt;/em&gt;&lt;/strong&gt; 
There is no downtime related to failures or intentionally taking down a node 
for maintenance, since there is no failover. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Automatic Node Provisioning&lt;/em&gt;&lt;/strong&gt; 
There&amp;rsquo;s no need to backup manually the database and copy it to the new node. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Supports InnoDB&lt;/em&gt;&lt;/strong&gt; 
The InnoDB storage engine provides for transactional tables. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;Transparent to Applications&lt;/em&gt;&lt;/strong&gt; 
Generally, you won&amp;rsquo;t have to change an application that will interface with the database
 as a result of Galera. If you do, it will be minimal changes. &lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;em&gt;No Read and Write Splitting Needed&lt;/em&gt;&lt;/strong&gt; 
There is no need to split read and write queries.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Pada tutorial ini instalasi di lakukan di OS Ubuntu 20.04, tutorial ini harusnya bisa juga di implementasikan di Debian 10 dan turunannya.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Requirements:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;3 server dengan OS Linux varian Ubuntu 20.04 atau Debian 10 fresh install dengan akses &lt;code&gt;root&lt;/code&gt; atau &lt;code&gt;sudo&lt;/code&gt; sebagai instance database server.
1 server dengan OS Linux varian Ubuntu 20.04 atau Debian 10 fresh install dengan akses &lt;code&gt;root&lt;/code&gt; atau &lt;code&gt;sudo&lt;/code&gt; sebagai instance proxy server.
(optional) server bisa saling terhubung menggunakan hostname&lt;/p&gt;
&lt;p&gt;Server yang digunakan:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;192.168.30.63   db1&lt;/span&gt;
&lt;span class="x"&gt;192.168.30.64   db2&lt;/span&gt;
&lt;span class="x"&gt;192.168.30.64   db3&lt;/span&gt;
&lt;span class="x"&gt;192.168.30.200  proxy&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Proses Instalasi:&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Seperti biasa lakukan update terlebih dahulu sebelum menginstall paket.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;update&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;install&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mariadb&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;rsync&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Untuk Debian karena pada Debian 10 versi MariaDB-10 belum ada di repository, maka bisa menggunakan repo dari MariaDB&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;update&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;install&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;dirmngr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;software&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;properties&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;common&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;key&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;adv&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nx"&gt;recv&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;keys&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="nx"&gt;keyserver&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;hkp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//keyserver.ubuntu.com:80 0xF1656F24C74CD1D8 &lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;add&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;repository&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;'&lt;/span&gt;&lt;span class="nx"&gt;deb&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;arch&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="nx"&gt;amd64&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//nyc2.mirrors.digitalocean.com/mariadb/repo/10.1/debian buster main'&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;update&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;apt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;install&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mariadb&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;rsync&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Jalankan perintah itu untuk menginstall Mariadb di ketiga server.
Setelah selesai instalasi, setting password root untuk database dan selanjutnya kita akan matikan service terlebih dahulu karna kita akan melakukan konfigurasi.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mysql&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;u&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;root&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Kemudian setting password untuk MariaDB root&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;MariaDB&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"p@55w0Rd123"&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Jika sukses maka output seperti ini akan muncul
&lt;img alt="mariadb1 img!" src="images/mariadb1.png" title="mariadb password success"/&gt;
Selanjutnya keluar dari mariadb dengan perintah &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="n"&gt;MariaDB&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;none&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;]&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Setlah itu kita akan melakukan config Galera, sebelum itu matikan terlebih dahulu servicenya.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;systemctl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;stop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mariadb&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Setup Galera cluster&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Konfigurasi Galera cluster ada di &lt;code&gt;/etc/mysql/mariadb.conf.d/50-galera.cnf&lt;/code&gt;
Edit file tersebut dan tambahkan config seperti berikut:
&lt;code&gt;$ sudo vim /etc/mysql/mariadb.conf.d/50-galera.cnf&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;mysqld&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;binlog_format&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ROW&lt;/span&gt;
&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;storage&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;engine&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;innodb&lt;/span&gt;
&lt;span class="n"&gt;innodb_autoinc_lock_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mf"&gt;192.168.30.63&lt;/span&gt;

&lt;span class="c1"&gt;# Galera Provider Configuration&lt;/span&gt;
&lt;span class="n"&gt;wsrep_on&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;ON&lt;/span&gt;
&lt;span class="n"&gt;wsrep_provider&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;galera&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;libgalera_smm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;so&lt;/span&gt;

&lt;span class="n"&gt;wsrep_cluster_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"galera_cluster"&lt;/span&gt;
&lt;span class="n"&gt;wsrep_cluster_address&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"gcomm://192.168.30.63,192.168.30.64,192.168.30.65"&lt;/span&gt;

&lt;span class="n"&gt;wsrep_sst_method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;rsync&lt;/span&gt;

&lt;span class="n"&gt;wsrep_node_address&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"192.168.30.63"&lt;/span&gt;
&lt;span class="n"&gt;wsrep_node_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;"db1"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Karena kita sudah setting binding-address IP kita di &lt;strong&gt;50-galera.cnf&lt;/strong&gt; maka kita akan menghapus setting tersebut dari file &lt;strong&gt;50-server.cnf&lt;/strong&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;'&lt;/span&gt;&lt;span class="nx"&gt;s&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;address&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="nx"&gt;bind&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;address&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;g&lt;/span&gt;&lt;span class="err"&gt;'&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;mariadb&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;d&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;server&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;cnf&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Selanjutnya edit di node berikutnya file &lt;strong&gt;50-galera.cnf&lt;/strong&gt; tersebut, isi dari config boleh di copy, yang perlu diubah hanya pada bagian berikut&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="x"&gt;wsrep_node_address=&lt;/span&gt;
&lt;span class="x"&gt;wsrep_node_name=&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ganti dengan hostname dan ip dari masing-masing server. &lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Firwall Config (Optional)&lt;/em&gt;&lt;/strong&gt;
Secara default biasanya Ubuntu dan Debian tidak mengaktifkan firewall service, namun untuk production sangat disarankan agar service tersebut dinyalakan. Untuk management firewall di Debian Base bisa menggunakan UFW ataupun Firewalld seperti di keluarga &lt;strong&gt;RedHat&lt;/strong&gt;, namun agar lebih seragam maka tutorial ini akan menggunakan UFW sebagai manajemen firewallnya.&lt;/p&gt;
&lt;p&gt;Port yang perlu di buka agar service-service yang dibutuhkan untuk Galera Cluster bisa berfungsi:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;3306&lt;/strong&gt; Port yang digunakan untuk MySQL/MariaDB Database berkomunikasi, merupakan default service port (meskipun port ini bisa diubah tetapi tidak direkomendasikan untuk mengubahnya).&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;4567&lt;/strong&gt; Port untuk Galera Cluster Replication traffic. Multicast replication akan menggunakan UDP dan TCP pada port ini.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;4568&lt;/strong&gt; Port untuk incremental transfer state.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;4444&lt;/strong&gt; Port untuk fitur lain seperti snapshot dari galera service.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Untuk mengallow akses firewall pada ufw menggunakan command berikut:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;ufw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;allow&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.30.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;proto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;tcp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;any&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4567&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4568&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4444&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;ufw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;allow&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.30.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;proto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;udp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;any&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4567&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Perhatikan perintah diatas, ubah ip dan subnet sesuai dengan subnet yang digunakan, atau jika ingin mengallow ke semua &lt;strong&gt;(kurang aman dan kurang direkomendasikan)&lt;/strong&gt; bisa menggunakan perintah berikut:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;ufw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;allow&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3306&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4567&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4568&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;4444&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;tcp&lt;/span&gt;
&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;ufw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;allow&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;4567&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nx"&gt;udp&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;Start Galera Cluster&lt;/em&gt;&lt;/strong&gt;
Selanjutnya start Galera Cluster dari node pertama&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;galera_new_cluster&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Selanjutnya cek status wsrep dengan login ke mysql shell&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mysql&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;u&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;root&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nx"&gt;e&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;"SHOW STATUS LIKE 'wsrep_cluster_size'"&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Jika sukses maka akan muncul tampilan berikut:&lt;/p&gt;
&lt;p&gt;Selanjutnya start service mariadb-server di node 2 dan 3&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;systemctl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;start&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mysql&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;dan cek kembali wsrep status nya, jika server db node 2 dan 3 juga sukses, maka ukuran &lt;strong&gt;wsrep_cluster_size&lt;/strong&gt; nya akan bertambah seperti gambar berikut:&lt;/p&gt;
&lt;p&gt;Sampai disini dulu tutorial &lt;strong&gt;part 1&lt;/strong&gt; ini, untuk testing replication akan kita sambung di part berikutnya.&lt;br/&gt;
😁 😁 😁&lt;/p&gt;</content><category term="misc"></category><category term="Mariadb"></category><category term="linux"></category><category term="database"></category><category term="cluster"></category></entry><entry><title>Apa itu Cluster?</title><link href="/apa-itu-cluster.html" rel="alternate"></link><published>2014-06-10T13:30:00+07:00</published><updated>2014-06-10T13:30:00+07:00</updated><author><name>me</name></author><id>tag:None,2014-06-10:/apa-itu-cluster.html</id><summary type="html">&lt;p&gt;Mengenal apa itu Clustering system&lt;/p&gt;</summary><content type="html">&lt;p&gt;Apa itu Cluster?&lt;/p&gt;
&lt;p&gt;&lt;img alt="cluster img!" src="images/cluster-img2.png" title="cluster2.img"/&gt;&lt;/p&gt;
&lt;p&gt;Teknik Clustering di dalam system komputer adalah teknik menggabungkan beberapa server atau instance menjadi sebuah resource system yang bisa digunakan untuk berbagai keperluan.
Clustering pada system komputer sendiri bisa merupakan Hardware Cluster maupun Software Cluster.&lt;/p&gt;
&lt;p&gt;Secara umum cluster bisa di kategorikan dalam 3 tipe, yaitu &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Load Balancing Cluster
Cluster dengan mode Load Balance bekerja dengan membagi (distribusi) beban ke beberapa resource yang ada, sehingga tidak terjadi overload pada salah satu server  dan menyebabkan pengguna tidak dapat mengakses system atau aplikasi.&lt;/li&gt;
&lt;li&gt;High Avability Cluster
Sedangkan High Avability Cluster adalah type cluster yang memastikan system atau service selalu bisa diakses meskipun ada salah satu server yang mati / down.&lt;/li&gt;
&lt;li&gt;Fail-Over-Cluster
Cluster mode ini bekerja dengan cara hot-standby atau master-slave, sehingga sebenarnya hanya server yang akan bekerja pada satu waktu, namun jika master atau server utama mengalami down atau gangguan, maka slave atau hot-stanby server akan mengambil alih.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="cluster image!" src="images/cluster-img1.png" title="clustering model"/&gt;&lt;/p&gt;
&lt;p&gt;Clustering pada system komputer memiliki benefit diantaranya:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;High Avability &lt;/li&gt;
&lt;li&gt;Redundancy / Fault Tolerance&lt;/li&gt;
&lt;li&gt;Scalability&lt;/li&gt;
&lt;li&gt;Load Balance&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Meski memiliki benefit, namun clustering system sendiri juga memiliki kekurangan diantaranya:
* High Cost
* Not easy to Setup and Maintain&lt;/p&gt;</content><category term="misc"></category><category term="server"></category><category term="cluster"></category><category term="load-balance"></category><category term="ha"></category></entry></feed>